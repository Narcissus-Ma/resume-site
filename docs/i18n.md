# 国际化（i18n）方案实现文档

## 1. 概述

本文档详细描述了简历网站的国际化方案，实现对中文、英文和日语的支持。方案分为UI层面和数据层面两个部分，通过一键翻译脚本实现多语言内容的快速生成。

### 1.1 目标

- 支持中文（zh-CN）、英文（en-US）和日语（ja-JP）三种语言
- UI层面的文本翻译
- 数据层面的内容翻译（简历数据和首页数据）
- 提供一键翻译功能，从中文内容生成其他语言的JSON文件
- 管理界面支持多语言内容的编辑和管理

## 2. 技术选型

| 层面 | 技术方案 | 原因 |
|------|---------|------|
| UI国际化 | react-i18next | 轻量级、易集成、支持React Hooks |
| 数据国际化 | 独立JSON文件结构 | 便于管理和翻译，支持一键生成 |
| 翻译工具 | 百度翻译API（或其他翻译服务） | 支持多语言翻译，易于集成 |
| 构建工具 | Node.js脚本 | 便于自动化翻译和文件生成 |

## 3. UI层面国际化实现

### 3.1 安装依赖

```bash
npm install react-i18next i18next
```

### 3.2 创建配置文件

创建 `src/i18n/config.ts` 文件：

```typescript
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';

// 导入翻译资源
import zhCN from './locales/zh-CN.json';
import enUS from './locales/en-US.json';
import jaJP from './locales/ja-JP.json';

const resources = {
  'zh-CN': {
    translation: zhCN
  },
  'en-US': {
    translation: enUS
  },
  'ja-JP': {
    translation: jaJP
  }
};

i18n
  .use(initReactI18next)
  .init({
    resources,
    lng: 'zh-CN', // 默认语言
    fallbackLng: 'zh-CN', // 回退语言
    interpolation: {
      escapeValue: false // React已经处理了XSS
    }
  });

export default i18n;
```

### 3.3 创建翻译资源文件

创建 `src/i18n/locales/` 目录，包含以下文件：

**zh-CN.json** (中文资源文件)
```json
{
  "common": {
    "home": "首页",
    "resume": "简历",
    "contact": "联系我",
    "edit": "编辑",
    "save": "保存",
    "cancel": "取消"
  },
  "header": {
    "title": "个人简历",
    "settings": "设置"
  },
  "footer": {
    "copyright": "© 2024 个人简历网站"
  },
  "resume": {
    "personalInfo": "个人信息",
    "education": "教育经历",
    "experience": "工作经历",
    "skills": "专业技能",
    "projects": "项目经验"
  },
  "home": {
    "welcome": "欢迎访问我的个人网站",
    "intro": "我是一名前端开发者，热爱技术，追求卓越"
  }
}
```

**en-US.json** (英文资源文件)
```json
{
  "common": {
    "home": "Home",
    "resume": "Resume",
    "contact": "Contact",
    "edit": "Edit",
    "save": "Save",
    "cancel": "Cancel"
  },
  "header": {
    "title": "Personal Resume",
    "settings": "Settings"
  },
  "footer": {
    "copyright": "© 2024 Personal Resume Website"
  },
  "resume": {
    "personalInfo": "Personal Information",
    "education": "Education",
    "experience": "Work Experience",
    "skills": "Skills",
    "projects": "Projects"
  },
  "home": {
    "welcome": "Welcome to my personal website",
    "intro": "I am a frontend developer, passionate about technology and pursuing excellence"
  }
}
```

**ja-JP.json** (日语资源文件)
```json
{
  "common": {
    "home": "ホーム",
    "resume": "履歴書",
    "contact": "お問い合わせ",
    "edit": "編集",
    "save": "保存",
    "cancel": "キャンセル"
  },
  "header": {
    "title": "個人履歴書",
    "settings": "設定"
  },
  "footer": {
    "copyright": "© 2024 個人履歴書ウェブサイト"
  },
  "resume": {
    "personalInfo": "個人情報",
    "education": "学歴",
    "experience": "職務経歴",
    "skills": "スキル",
    "projects": "プロジェクト経験"
  },
  "home": {
    "welcome": "私のパーソナルウェブサイトへようこそ",
    "intro": "私はフロントエンド開発者で、技術に情熱を持ち、卓越性を追求しています"
  }
}
```

### 3.4 在应用中使用

#### 3.4.1 初始化i18n

在 `src/main.tsx` (或入口文件) 中导入配置：

```typescript
import './i18n/config';
```

#### 3.4.2 在组件中使用翻译

使用 `useTranslation` Hook 进行翻译：

```typescript
import { useTranslation } from 'react-i18next';

const Header = () => {
  const { t } = useTranslation();
  
  return (
    <header>
      <h1>{t('header.title')}</h1>
      <nav>
        <a href="/">{t('common.home')}</a>
        <a href="/resume">{t('common.resume')}</a>
        <a href="/contact">{t('common.contact')}</a>
      </nav>
    </header>
  );
};
```

#### 3.4.3 创建语言切换组件

创建 `src/components/LanguageSelector.tsx`：

```typescript
import { useTranslation } from 'react-i18next';
import { Select } from 'antd';

const { Option } = Select;

const LanguageSelector = () => {
  const { i18n } = useTranslation();

  const handleChange = (value: string) => {
    i18n.changeLanguage(value);
  };

  return (
    <Select 
      value={i18n.language} 
      onChange={handleChange} 
      style={{ width: 120 }}
    >
      <Option value="zh-CN">中文</Option>
      <Option value="en-US">English</Option>
      <Option value="ja-JP">日本語</Option>
    </Select>
  );
};

export default LanguageSelector;
```

## 4. 数据层面国际化实现

### 4.1 数据文件结构

将原有的数据文件拆分为多语言版本：

- `src/data/resumeData_zh-CN.json` (中文简历数据)
- `src/data/resumeData_en-US.json` (英文简历数据)
- `src/data/resumeData_ja-JP.json` (日语简历数据)
- `src/data/homeData_zh-CN.json` (中文首页数据)
- `src/data/homeData_en-US.json` (英文首页数据)
- `src/data/homeData_ja-JP.json` (日语首页数据)

### 4.2 创建数据加载Hook

创建 `src/hooks/use-translated-data.ts`：

```typescript
import { useTranslation } from 'react-i18next';
import resumeDataZhCN from '../data/resumeData_zh-CN.json';
import resumeDataEnUS from '../data/resumeData_en-US.json';
import resumeDataJaJP from '../data/resumeData_ja-JP.json';
import homeDataZhCN from '../data/homeData_zh-CN.json';
import homeDataEnUS from '../data/homeData_en-US.json';
import homeDataJaJP from '../data/homeData_ja-JP.json';

// 简历数据映射
const resumeDataMap = {
  'zh-CN': resumeDataZhCN,
  'en-US': resumeDataEnUS,
  'ja-JP': resumeDataJaJP
};

// 首页数据映射
const homeDataMap = {
  'zh-CN': homeDataZhCN,
  'en-US': homeDataEnUS,
  'ja-JP': homeDataJaJP
};

// 使用简历数据的Hook
export const useResumeData = () => {
  const { i18n } = useTranslation();
  return resumeDataMap[i18n.language] || resumeDataMap['zh-CN'];
};

// 使用首页数据的Hook
export const useHomeData = () => {
  const { i18n } = useTranslation();
  return homeDataMap[i18n.language] || homeDataMap['zh-CN'];
};
```

### 4.3 在组件中使用数据

```typescript
import { useResumeData } from '../hooks/use-translated-data';

const Resume = () => {
  const resumeData = useResumeData();
  
  return (
    <div className="resume">
      <section className="personal-info">
        <h2>个人信息</h2>
        <p>姓名：{resumeData.personalInfo.name}</p>
        <p>邮箱：{resumeData.personalInfo.email}</p>
        <p>电话：{resumeData.personalInfo.phone}</p>
      </section>
      {/* 其他部分 */}
    </div>
  );
};
```

## 5. 翻译脚本实现

### 5.1 创建翻译脚本

创建 `scripts/translate-data.js` 文件：

```javascript
const fs = require('fs');
const path = require('path');
const axios = require('axios');

// 翻译API配置（这里使用百度翻译API示例）
const BAIDU_APP_ID = 'your_app_id'; // 请替换为你的百度翻译APP ID
const BAIDU_SECRET_KEY = 'your_secret_key'; // 请替换为你的百度翻译密钥

// 源数据文件路径
const SOURCE_DATA_DIR = path.resolve(__dirname, '../src/data');
const SOURCE_LANG = 'zh-CN';
const TARGET_LANGS = ['en-US', 'ja-JP'];

// 百度翻译API调用函数
async function translateText(text, targetLang) {
  // 根据目标语言代码转换为百度翻译API的语言代码
  const langMap = {
    'en-US': 'en',
    'ja-JP': 'jp'
  };
  
  const from = 'zh';
  const to = langMap[targetLang] || targetLang;
  
  try {
    // 调用百度翻译API
    const response = await axios.post('https://fanyi-api.baidu.com/api/trans/vip/translate', null, {
      params: {
        q: text,
        appid: BAIDU_APP_ID,
        salt: Math.random().toString(36).substring(2),
        from,
        to,
        sign: generateSign(text, BAIDU_APP_ID, BAIDU_SECRET_KEY)
      }
    });
    
    return response.data.trans_result?.[0]?.dst || text;
  } catch (error) {
    console.error(`翻译失败: ${text}`, error);
    return text; // 翻译失败时返回原文
  }
}

// 生成百度翻译API的签名
function generateSign(query, appid, secretKey) {
  const salt = Math.random().toString(36).substring(2);
  const str = appid + query + salt + secretKey;
  return require('crypto').createHash('md5').update(str).digest('hex');
}

// 递归翻译JSON对象
async function translateJson(obj, targetLang) {
  const result = {};
  
  for (const key in obj) {
    if (typeof obj[key] === 'string') {
      result[key] = await translateText(obj[key], targetLang);
      console.log(`翻译: ${obj[key]} -> ${result[key]}`);
    } else if (Array.isArray(obj[key])) {
      result[key] = [];
      for (const item of obj[key]) {
        result[key].push(await translateJson(item, targetLang));
      }
    } else if (typeof obj[key] === 'object' && obj[key] !== null) {
      result[key] = await translateJson(obj[key], targetLang);
    } else {
      result[key] = obj[key];
    }
  }
  
  return result;
}

// 翻译单个数据文件
async function translateDataFile(filename, targetLang) {
  const sourcePath = path.join(SOURCE_DATA_DIR, `${filename}_${SOURCE_LANG}.json`);
  const targetPath = path.join(SOURCE_DATA_DIR, `${filename}_${targetLang}.json`);
  
  console.log(`正在翻译文件: ${sourcePath} -> ${targetPath}`);
  
  // 读取源文件
  const sourceData = JSON.parse(fs.readFileSync(sourcePath, 'utf8'));
  
  // 翻译数据
  const translatedData = await translateJson(sourceData, targetLang);
  
  // 写入目标文件
  fs.writeFileSync(targetPath, JSON.stringify(translatedData, null, 2), 'utf8');
  
  console.log(`翻译完成: ${targetPath}`);
}

// 翻译所有数据文件
async function translateAllData() {
  // 获取所有源数据文件
  const sourceFiles = fs.readdirSync(SOURCE_DATA_DIR)
    .filter(file => file.endsWith(`_${SOURCE_LANG}.json`))
    .map(file => file.replace(`_${SOURCE_LANG}.json`, ''));
  
  for (const file of sourceFiles) {
    for (const lang of TARGET_LANGS) {
      await translateDataFile(file, lang);
    }
  }
  
  console.log('所有文件翻译完成！');
}

// 执行翻译
translateAllData();
```

### 5.2 安装依赖

```bash
npm install axios crypto --save-dev
```

### 5.3 配置脚本命令

在 `package.json` 中添加脚本：

```json
{
  "scripts": {
    "translate": "node scripts/translate-data.js"
  }
}
```

### 5.4 运行翻译脚本

```bash
npm run translate
```

## 6. 管理界面国际化支持

### 6.1 数据管理

在管理界面中，只允许编辑中文数据文件，其他语言的数据通过翻译脚本生成。

### 6.2 翻译后处理

翻译完成后，需要对自动翻译的内容进行人工校对，确保翻译质量。

## 7. 部署和维护

### 7.1 部署

国际化方案对部署流程没有特殊要求，按照原有的部署流程即可。

### 7.2 维护

- 新增内容时，只需要修改中文资源文件和数据文件
- 运行 `npm run translate` 生成其他语言的内容
- 对自动翻译的内容进行人工校对

## 8. 总结

本国际化方案具有以下优势：

1. **分离清晰**：UI层面和数据层面的国际化分离处理
2. **易于维护**：只需要维护中文内容，其他语言通过脚本生成
3. **扩展性强**：可以轻松添加新的语言支持
4. **用户体验好**：支持语言切换，提供本地化的内容

### 注意事项

1. 自动翻译的质量有限，需要人工校对
2. 部分专业术语可能需要手动调整
3. 翻译API可能需要付费，根据实际使用情况选择合适的API
4. 数据量大时，翻译时间可能较长，可以考虑分批翻译

---

## 附录：项目文件结构

```
├── src/
│   ├── components/
│   │   ├── LanguageSelector.tsx  # 语言切换组件
│   │   └── ...
│   ├── data/
│   │   ├── resumeData_zh-CN.json  # 中文简历数据
│   │   ├── resumeData_en-US.json  # 英文简历数据
│   │   ├── resumeData_ja-JP.json  # 日语简历数据
│   │   ├── homeData_zh-CN.json    # 中文首页数据
│   │   ├── homeData_en-US.json    # 英文首页数据
│   │   └── homeData_ja-JP.json    # 日语首页数据
│   ├── hooks/
│   │   ├── use-translated-data.ts  # 数据翻译Hook
│   │   └── ...
│   ├── i18n/
│   │   ├── config.ts              # i18n配置
│   │   └── locales/               # 翻译资源
│   │       ├── zh-CN.json         # 中文资源
│   │       ├── en-US.json         # 英文资源
│   │       └── ja-JP.json         # 日语资源
│   └── main.tsx                   # 应用入口
├── scripts/
│   └── translate-data.js          # 翻译脚本
├── docs/
│   └── i18n.md                   # 国际化方案文档
└── package.json
```